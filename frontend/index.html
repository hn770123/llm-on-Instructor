<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instructor Framework Demo - æ§‹é€ åŒ–å‡ºåŠ›ã‚µãƒ³ãƒ—ãƒ«</title>
    <style>
        /* å…¨ä½“ã®ã‚¹ã‚¿ã‚¤ãƒ«è¨­å®š */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨åˆ†ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 30px;
        }

        /* å…¥åŠ›ã‚¨ãƒªã‚¢ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .input-section, .output-section {
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .section-title {
            font-size: 1.5em;
            margin-bottom: 15px;
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        /* ãƒ•ã‚©ãƒ¼ãƒ è¦ç´ ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
        }

        textarea, select, input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
            transition: border-color 0.3s;
        }

        textarea:focus, select:focus, input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }

        textarea {
            min-height: 150px;
            resize: vertical;
        }

        /* ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        button {
            flex: 1;
            padding: 14px 28px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        /* å‡ºåŠ›ã‚¨ãƒªã‚¢ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .output-content {
            background: white;
            padding: 20px;
            border-radius: 6px;
            border: 2px solid #ddd;
            min-height: 300px;
            max-height: 500px;
            overflow-y: auto;
        }

        .output-content pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
        }

        /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .status {
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 15px;
            display: none;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }

        .status.loading {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
            display: block;
        }

        /* ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚­ãƒ¼ãƒã‚¨ãƒªã‚¢ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .custom-schema-area {
            display: none;
            margin-top: 15px;
        }

        .custom-schema-area.active {
            display: block;
        }

        /* ãƒ˜ãƒ«ãƒ—ãƒ†ã‚­ã‚¹ãƒˆã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .help-text {
            font-size: 0.9em;
            color: #6c757d;
            margin-top: 5px;
        }

        /* ä¾‹æ–‡ã‚¨ãƒªã‚¢ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .examples {
            margin-top: 15px;
            padding: 15px;
            background: #e7f3ff;
            border-radius: 6px;
            border-left: 4px solid #667eea;
        }

        .examples h4 {
            margin-bottom: 10px;
            color: #333;
        }

        .example-item {
            margin-bottom: 8px;
            padding: 8px;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .example-item:hover {
            background: #f0f0f0;
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ */
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            header h1 {
                font-size: 1.8em;
            }

            .button-group {
                flex-direction: column;
            }
        }

        /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨åˆ† -->
        <header>
            <h1>ğŸ¤– Instructor Framework Demo</h1>
            <p>LLMã‹ã‚‰æ§‹é€ åŒ–ã•ã‚ŒãŸå‡ºåŠ›ã‚’å–å¾—ã™ã‚‹ãƒ‡ãƒ¢ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³</p>
            <p style="font-size: 0.9em; margin-top: 10px;">Ollama (llama3.1:8b) + Instructor</p>
        </header>

        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
        <div class="main-content">
            <!-- å…¥åŠ›ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div class="input-section">
                <h2 class="section-title">ğŸ“ å…¥åŠ›è¨­å®š</h2>

                <!-- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå…¥åŠ›ã‚¨ãƒªã‚¢ -->
                <div class="form-group">
                    <label for="prompt">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:</label>
                    <textarea
                        id="prompt"
                        placeholder="ã“ã“ã«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..."
                    >ç”°ä¸­å¤ªéƒã¯35æ­³ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã§ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯tanaka@example.comã§ã™ã€‚</textarea>
                    <p class="help-text">LLMã«é€ä¿¡ã™ã‚‹ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>
                </div>

                <!-- ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé¸æŠ -->
                <div class="form-group">
                    <label for="formatType">å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ:</label>
                    <select id="formatType">
                        <option value="user">ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±</option>
                        <option value="product">è£½å“æƒ…å ±</option>
                        <option value="article">è¨˜äº‹æƒ…å ±</option>
                        <option value="tasklist">ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆ</option>
                        <option value="custom">ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ</option>
                    </select>
                    <p class="help-text">æ§‹é€ åŒ–å‡ºåŠ›ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’é¸æŠã—ã¦ãã ã•ã„</p>
                </div>

                <!-- ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚­ãƒ¼ãƒã‚¨ãƒªã‚¢ï¼ˆã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé¸æŠæ™‚ã®ã¿è¡¨ç¤ºï¼‰ -->
                <div class="custom-schema-area" id="customSchemaArea">
                    <div class="form-group">
                        <label for="customSchema">ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚­ãƒ¼ãƒ (JSON):</label>
                        <textarea
                            id="customSchema"
                            placeholder='{"field1": "str", "field2": "int"}'
                            rows="5"
                        ></textarea>
                        <p class="help-text">ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®ã‚¹ã‚­ãƒ¼ãƒã‚’JSONå½¢å¼ã§å…¥åŠ›</p>
                    </div>
                </div>

                <!-- ä¾‹æ–‡ã‚¨ãƒªã‚¢ -->
                <div class="examples">
                    <h4>ğŸ“Œ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹:</h4>
                    <div class="example-list" id="exampleList">
                        <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
                    </div>
                </div>

                <!-- ãƒœã‚¿ãƒ³ã‚°ãƒ«ãƒ¼ãƒ— -->
                <div class="button-group">
                    <button class="btn-primary" id="generateBtn">
                        ç”Ÿæˆ
                    </button>
                    <button class="btn-secondary" id="clearBtn">
                        ã‚¯ãƒªã‚¢
                    </button>
                </div>
            </div>

            <!-- å‡ºåŠ›ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div class="output-section">
                <h2 class="section-title">ğŸ“Š å‡ºåŠ›çµæœ</h2>

                <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
                <div class="status" id="status"></div>

                <!-- å‡ºåŠ›å†…å®¹ -->
                <div class="output-content" id="output">
                    <p style="color: #999; text-align: center; padding: 50px 20px;">
                        å‡ºåŠ›çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // =============================================================================
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã¨å®šæ•°
        // =============================================================================

        // APIã®ãƒ™ãƒ¼ã‚¹URLï¼ˆå®Ÿéš›ã®ç’°å¢ƒã«åˆã‚ã›ã¦å¤‰æ›´ï¼‰
        const API_BASE_URL = 'http://localhost:8000';

        // DOMè¦ç´ ã®å–å¾—
        const promptTextarea = document.getElementById('prompt');
        const formatTypeSelect = document.getElementById('formatType');
        const customSchemaArea = document.getElementById('customSchemaArea');
        const customSchemaTextarea = document.getElementById('customSchema');
        const generateBtn = document.getElementById('generateBtn');
        const clearBtn = document.getElementById('clearBtn');
        const statusDiv = document.getElementById('status');
        const outputDiv = document.getElementById('output');
        const exampleList = document.getElementById('exampleList');

        // å„ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®ä¾‹æ–‡ãƒ‡ãƒ¼ã‚¿
        const examples = {
            user: [
                'ç”°ä¸­å¤ªéƒã¯35æ­³ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã§ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯tanaka@example.comã§ã™ã€‚',
                'ä½è—¤èŠ±å­ã€28æ­³ã€ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ã€satoh.hanako@design.jp',
                'å±±ç”°æ¬¡éƒã¯42æ­³ã®æ•™å¸«ã§ã™ã€‚'
            ],
            product: [
                'iPhone 15ã¯149,800å††ã®ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã§ã€æœ€æ–°ã®A17ãƒãƒƒãƒ—ã‚’æ­è¼‰ã—ã¦ã„ã¾ã™ã€‚åœ¨åº«ã‚ã‚Šã€‚',
                'ãƒ¯ã‚¤ãƒ¤ãƒ¬ã‚¹ã‚¤ãƒ¤ãƒ›ãƒ³ã€ä¾¡æ ¼8,900å††ã€ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã‚«ãƒ†ã‚´ãƒªã€ãƒã‚¤ã‚ºã‚­ãƒ£ãƒ³ã‚»ãƒªãƒ³ã‚°æ©Ÿèƒ½ä»˜ãã€åœ¨åº«åˆ‡ã‚Œ',
                'ãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³ Core i7ã€ãƒ¡ãƒ¢ãƒª16GBã€SSD512GBã€ä¾¡æ ¼128,000å††ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã‚«ãƒ†ã‚´ãƒªãƒ¼ã€åœ¨åº«ã‚ã‚Š'
            ],
            article: [
                'å±±ç”°èŠ±å­ãŒæ›¸ã„ãŸã€ŒAIã®æœªæ¥ã€ã¨ã„ã†è¨˜äº‹ã¯ã€äººå·¥çŸ¥èƒ½ã®ç™ºå±•ã«ã¤ã„ã¦è«–ã˜ã¦ã„ã¾ã™ã€‚ã‚¿ã‚°: AI, æ©Ÿæ¢°å­¦ç¿’, æœªæ¥ã€‚å…¬é–‹æ—¥: 2024å¹´1æœˆ15æ—¥',
                'ã€Œã‚¯ãƒ©ã‚¦ãƒ‰ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å…¥é–€ã€ã€è‘—è€…: éˆ´æœ¨å¤ªéƒã€ã‚¯ãƒ©ã‚¦ãƒ‰æŠ€è¡“ã®åŸºç¤ã‚’è§£èª¬ã€‚ã‚¿ã‚°: ã‚¯ãƒ©ã‚¦ãƒ‰, AWS, Azure',
                'ä½è—¤ä¸€éƒã«ã‚ˆã‚‹ã€Œãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã®æ¯”è¼ƒã€ã¯ã€Pythonã€JavaScriptã€Goã®ç‰¹å¾´ã‚’æ¯”è¼ƒã€‚2024å¹´2æœˆ1æ—¥å…¬é–‹ã€‚ã‚¿ã‚°: ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°, è¨€èªæ¯”è¼ƒ'
            ],
            tasklist: [
                'Webã‚µã‚¤ãƒˆãƒªãƒ‹ãƒ¥ãƒ¼ã‚¢ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã€ãƒ‡ã‚¶ã‚¤ãƒ³ä½œæˆ(é«˜å„ªå…ˆåº¦ã€ç· åˆ‡: 2024-02-01)ã€ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°(ä¸­å„ªå…ˆåº¦ã€ç· åˆ‡: 2024-02-15)ã€ãƒ†ã‚¹ãƒˆ(ä½å„ªå…ˆåº¦ã€ç· åˆ‡: 2024-02-28)ã®3ã¤ã®ã‚¿ã‚¹ã‚¯ãŒã‚ã‚Šã¾ã™ã€‚',
                'ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªé–‹ç™ºã€‚ã‚¿ã‚¹ã‚¯: è¦ä»¶å®šç¾©(é«˜)ã€UIè¨­è¨ˆ(ä¸­)ã€å®Ÿè£…(é«˜)ã€ãƒªãƒªãƒ¼ã‚¹æº–å‚™(ä½)ã€‚4ã¤ã®ã‚¿ã‚¹ã‚¯ã€‚',
                'å–¶æ¥­ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: é¡§å®¢ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—(é«˜ã€2024-01-31)ã€ææ¡ˆè³‡æ–™ä½œæˆ(ä¸­ã€2024-02-05)ã€ãƒ—ãƒ¬ã‚¼ãƒ³(é«˜ã€2024-02-10)'
            ],
            custom: [
                'ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚­ãƒ¼ãƒã‚’å®šç¾©ã—ã¦ãã ã•ã„'
            ]
        };

        // =============================================================================
        // åˆæœŸåŒ–å‡¦ç†
        // =============================================================================

        /**
         * ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
         */
        document.addEventListener('DOMContentLoaded', function() {
            // ä¾‹æ–‡ãƒªã‚¹ãƒˆã‚’åˆæœŸåŒ–
            updateExamples();

            // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
            formatTypeSelect.addEventListener('change', handleFormatChange);
            generateBtn.addEventListener('click', handleGenerate);
            clearBtn.addEventListener('click', handleClear);

            // ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œ
            checkAPIHealth();
        });

        // =============================================================================
        // ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼
        // =============================================================================

        /**
         * ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé¸æŠå¤‰æ›´æ™‚ã®å‡¦ç†
         */
        function handleFormatChange() {
            const selectedFormat = formatTypeSelect.value;

            // ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®å ´åˆã¯ã‚¹ã‚­ãƒ¼ãƒå…¥åŠ›ã‚¨ãƒªã‚¢ã‚’è¡¨ç¤º
            if (selectedFormat === 'custom') {
                customSchemaArea.classList.add('active');
            } else {
                customSchemaArea.classList.remove('active');
            }

            // ä¾‹æ–‡ãƒªã‚¹ãƒˆã‚’æ›´æ–°
            updateExamples();
        }

        /**
         * ç”Ÿæˆãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†
         */
        async function handleGenerate() {
            const prompt = promptTextarea.value.trim();
            const formatType = formatTypeSelect.value;
            const customSchema = customSchemaTextarea.value.trim();

            // å…¥åŠ›æ¤œè¨¼
            if (!prompt) {
                showStatus('error', 'ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            if (formatType === 'custom' && !customSchema) {
                showStatus('error', 'ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚­ãƒ¼ãƒã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            // ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
            setButtonsEnabled(false);

            // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
            showStatus('loading', 'ç”Ÿæˆä¸­... <span class="spinner"></span>');

            try {
                // APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡
                const response = await fetch(`${API_BASE_URL}/generate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        prompt: prompt,
                        format_type: formatType,
                        custom_schema: formatType === 'custom' ? customSchema : null
                    })
                });

                // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ãƒ‘ãƒ¼ã‚¹
                const data = await response.json();

                if (response.ok && data.success) {
                    // æˆåŠŸæ™‚ã®å‡¦ç†
                    showStatus('success', 'âœ… æ§‹é€ åŒ–å‡ºåŠ›ã®ç”Ÿæˆã«æˆåŠŸã—ã¾ã—ãŸ');
                    displayOutput(data);
                } else {
                    // ã‚¨ãƒ©ãƒ¼æ™‚ã®å‡¦ç†
                    showStatus('error', `âŒ ã‚¨ãƒ©ãƒ¼: ${data.detail || 'Unknown error'}`);
                    outputDiv.innerHTML = '<p style="color: red;">ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</p>';
                }
            } catch (error) {
                // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãªã©ã®å‡¦ç†
                showStatus('error', `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`);
                outputDiv.innerHTML = '<p style="color: red;">APIã¨ã®é€šä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ</p>';
            } finally {
                // ãƒœã‚¿ãƒ³ã‚’å†æœ‰åŠ¹åŒ–
                setButtonsEnabled(true);
            }
        }

        /**
         * ã‚¯ãƒªã‚¢ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†
         */
        function handleClear() {
            promptTextarea.value = '';
            customSchemaTextarea.value = '';
            outputDiv.innerHTML = '<p style="color: #999; text-align: center; padding: 50px 20px;">å‡ºåŠ›çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™</p>';
            statusDiv.className = 'status';
            statusDiv.textContent = '';
        }

        /**
         * ä¾‹æ–‡ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†
         */
        function handleExampleClick(exampleText) {
            promptTextarea.value = exampleText;
            // ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
            promptTextarea.focus();
        }

        // =============================================================================
        // UIæ›´æ–°é–¢æ•°
        // =============================================================================

        /**
         * ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
         */
        function showStatus(type, message) {
            statusDiv.className = `status ${type}`;
            statusDiv.innerHTML = message;
        }

        /**
         * å‡ºåŠ›çµæœã‚’è¡¨ç¤º
         */
        function displayOutput(data) {
            // JSONå½¢å¼ã§æ•´å½¢ã—ã¦è¡¨ç¤º
            const formattedData = JSON.stringify(data.data, null, 2);
            outputDiv.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <strong>ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚¿ã‚¤ãƒ—:</strong> ${data.format_type}
                </div>
                <pre>${formattedData}</pre>
            `;
        }

        /**
         * ãƒœã‚¿ãƒ³ã®æœ‰åŠ¹/ç„¡åŠ¹ã‚’åˆ‡ã‚Šæ›¿ãˆ
         */
        function setButtonsEnabled(enabled) {
            generateBtn.disabled = !enabled;
            clearBtn.disabled = !enabled;

            if (!enabled) {
                generateBtn.innerHTML = 'ç”Ÿæˆä¸­... <span class="spinner"></span>';
            } else {
                generateBtn.innerHTML = 'ç”Ÿæˆ';
            }
        }

        /**
         * ä¾‹æ–‡ãƒªã‚¹ãƒˆã‚’æ›´æ–°
         */
        function updateExamples() {
            const selectedFormat = formatTypeSelect.value;
            const exampleTexts = examples[selectedFormat] || [];

            exampleList.innerHTML = exampleTexts.map(text =>
                `<div class="example-item" onclick="handleExampleClick(\`${text}\`)">${text}</div>`
            ).join('');
        }

        /**
         * APIãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
         */
        async function checkAPIHealth() {
            try {
                const response = await fetch(`${API_BASE_URL}/health`);
                const data = await response.json();

                if (data.status === 'healthy') {
                    console.log('âœ… API is healthy');
                } else {
                    console.warn('âš ï¸ API is unhealthy:', data);
                }
            } catch (error) {
                console.error('âŒ Failed to connect to API:', error);
            }
        }
    </script>
</body>
</html>
